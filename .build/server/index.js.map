{"version":3,"names":["Server","loadConfig","playerSchema","globalsSchema","pluginPlatformInit","config","process","env","ENV","import","meta","url","console","log","app","name","pid","server","useDefaultApplicationTemplate","pluginManager","register","stateManager","registerSchema","globals","create","start"],"sources":["../../src/server/index.js"],"sourcesContent":["import '@soundworks/helpers/polyfills.js';\nimport { Server } from '@soundworks/core/server.js';\n\nimport { loadConfig } from '../utils/load-config.js';\nimport '../utils/catch-unhandled-errors.js';\n// import { globalsSchema } from './schemas/globals.js';\nimport { playerSchema } from './schemas/player.js';\nimport { globalsSchema } from './schemas/globals.js';\nimport pluginPlatformInit from '@soundworks/plugin-platform-init/server.js';\n\n// - General documentation: https://soundworks.dev/\n// - API documentation:     https://soundworks.dev/api\n// - Issue Tracker:         https://github.com/collective-soundworks/soundworks/issues\n// - Wizard & Tools:        `npx soundworks`\n\nconst config = loadConfig(process.env.ENV, import.meta.url);\n\nconsole.log(`\n--------------------------------------------------------\n- launching \"${config.app.name}\" in \"${process.env.ENV || 'default'}\" environment\n- [pid: ${process.pid}]\n--------------------------------------------------------\n`);\n\n/**\n * Create the soundworks server\n */\nconst server = new Server(config);\n// configure the server for usage within this application template\nserver.useDefaultApplicationTemplate();\n\nserver.pluginManager.register('platform-init', pluginPlatformInit);\n\nserver.stateManager.registerSchema('globals', globalsSchema);\nserver.stateManager.registerSchema('player', playerSchema);\n\nconst globals = await server.stateManager.create('globals');\n\n/**\n * Register plugins and schemas\n */\n// server.pluginManager.register('my-plugin', plugin);\n// server.stateManager.registerSchema('my-schema', definition);\n\n/**\n * Launch application (init plugins, http server, etc.)\n */\nawait server.start();\n\n// and do your own stuff!\n\n"],"mappings":"AAAA,OAAO,kCAAkC;AACzC,SAASA,MAAM,QAAQ,4BAA4B;AAEnD,SAASC,UAAU,QAAQ,yBAAyB;AACpD,OAAO,oCAAoC;AAC3C;AACA,SAASC,YAAY,QAAQ,qBAAqB;AAClD,SAASC,aAAa,QAAQ,sBAAsB;AACpD,OAAOC,kBAAkB,MAAM,4CAA4C;;AAE3E;AACA;AACA;AACA;;AAEA,MAAMC,MAAM,GAAGJ,UAAU,CAACK,OAAO,CAACC,GAAG,CAACC,GAAG,EAAEC,MAAM,CAACC,IAAI,CAACC,GAAG,CAAC;AAE3DC,OAAO,CAACC,GAAG,CAAE;AACb;AACA,eAAeR,MAAM,CAACS,GAAG,CAACC,IAAK,SAAQT,OAAO,CAACC,GAAG,CAACC,GAAG,IAAI,SAAU;AACpE,UAAUF,OAAO,CAACU,GAAI;AACtB;AACA,CAAC,CAAC;;AAEF;AACA;AACA;AACA,MAAMC,MAAM,GAAG,IAAIjB,MAAM,CAACK,MAAM,CAAC;AACjC;AACAY,MAAM,CAACC,6BAA6B,CAAC,CAAC;AAEtCD,MAAM,CAACE,aAAa,CAACC,QAAQ,CAAC,eAAe,EAAEhB,kBAAkB,CAAC;AAElEa,MAAM,CAACI,YAAY,CAACC,cAAc,CAAC,SAAS,EAAEnB,aAAa,CAAC;AAC5Dc,MAAM,CAACI,YAAY,CAACC,cAAc,CAAC,QAAQ,EAAEpB,YAAY,CAAC;AAE1D,MAAMqB,OAAO,GAAG,MAAMN,MAAM,CAACI,YAAY,CAACG,MAAM,CAAC,SAAS,CAAC;;AAE3D;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAMP,MAAM,CAACQ,KAAK,CAAC,CAAC;;AAEpB"}
