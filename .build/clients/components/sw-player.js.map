{"version":3,"names":["LitElement","html","css","live","throttle","SwPlayer","styles","constructor","player","_unobserve","updateVolume","volume","set","source","updateFilterSlider","filterSlider","sawFreq","get","filterFreq","Math","floor","max","numHarm","connectedCallback","onUpdate","requestUpdate","disconnectedCallback","render","e","Number","target","value","getSchema","min","customElements","define"],"sources":["../../../src/clients/components/sw-player.js"],"sourcesContent":["// src/players/components/sw-player.js\nimport { LitElement, html, css } from 'lit';\nimport { live } from 'lit/directives/live.js';\nimport throttle from 'lodash/throttle.js'\n\n// import needed GUI components\nimport '@ircam/sc-components/sc-slider.js';\nimport '@ircam/sc-components/sc-select.js';\n\nclass SwPlayer extends LitElement {\n  static styles = css`\n    :host {\n      display: block;\n      // min-height: calc(100vh - 70px);\n      width: inherit;\n      height: inherit;\n    }\n\n    header {\n      display: block;\n      height: 70px;\n      line-height: 70px;\n      background-color: var(--sw-medium-background-color);\n      display: flex;\n      flex-direction: row;\n      justify-content: space-between;\n      align-items: stretch;\n      border-bottom: 1px solid var(--sw-lighter-background-color);\n    }\n\n    p {\n      font-size: 30px;\n      margin: 4px;\n      height: 30px;\n      line-height: 30px;\n      text-indent: 0px;\n      background-color: #454545;\n    }\n\n    .filter > p {\n      margin: 15px;\n      line-height: 30px;\n      text-indent: 8px;\n    }\n\n    .volume > p {\n      padding: 15px;\n      marging: 0px;\n      line-height: 30px;\n      text-indent: 8px;\n    }\n\n    sc-select {\n      font-size: 30px;\n      height: 62px;\n      margin: 4px;\n      width: 120px;\n      background-color: #454545;\n    }\n\n    :host > div {\n      display: flex;\n      background-color: #121212;\n      justify-content: center;\n      flex-direction: row;\n      height: calc(100% - 71px);\n    }\n\n    sc-text {\n      font-size: 30px;\n      margin-top: 10px;\n      width: 100%;\n    }\n\n    sc-number {\n      margin-top: 10px;\n      font-size: 30px;\n      width: 100%;\n      height: 60px;\n    }\n\n    sc-slider {\n      margin-top: 10px;\n      width: 100%;\n      height: 100%;\n    }\n\n    .filter {\n      width: 49%;\n      height: inherit;\n    }\n\n    .volume {\n      width: 49%;\n      height: inherit;\n    }\n\n  `;\n\n  constructor() {\n    super();\n    // stores the `player` state\n    this.player = null;\n    // stores the `unsubscribe` callback returned by the `state.onUpdate` methos\n    // https://soundworks.dev/soundworks/client.SharedState.html#onUpdate\n    this._unobserve = null;\n\n    const updateVolume = throttle(function (volume) {\n      this.player.set({ volume: volume }, { source: 'web'});\n    }, 100, { 'trailing' : true});\n\n    const updateFilterSlider = throttle(function (filterSlider) {\n      const sawFreq = this.player.get('sawFreq');\n      const filterFreq = Math.floor(Math.max((filterSlider * sawFreq) * 7, 10));\n      const numHarm = Math.floor(filterFreq / sawFreq);\n      this.player.set({ filterFreq: filterFreq, numHarm: numHarm, filterSlider: filterSlider }, { source: 'web' });\n    }, 100, { 'trailing' : true});\n\n    this.updateVolume = updateVolume;\n    this.updateFilterSlider = updateFilterSlider;\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    // update the component when a state change occurs\n    this._unobserve = this.player.onUpdate(() => this.requestUpdate());\n  }\n\n  disconnectedCallback() {\n    super.disconnectedCallback();\n    // stop reacting to state change when the element is removed from the DOM\n    this._unobserve();\n  }\n\n  render() {\n    // create controls for the player state\n    return html`\n      <header>\n        <div>\n          <p>${this.player.get('id')}</p>\n          <p>${this.player.get('filterFreq')}Hz|${this.player.get('numHarm')}'</p>\n        </div>\n        <sc-select\n          value=\"${this.player.get('sawFreq')}\"\n          .options=${this.player.get('selectFreq')}\n          @change=${e => this.player.set({ sawFreq: Number(e.target.value) }, { source:'web' })}\n        ></sc-select>\n      </header>\n      <div>\n        <div class=\"filter\">\n          <sc-slider\n            relative\n            orientation=\"vertical\"\n            min=\"${this.player.getSchema().filterSlider.min}\"\n            max=\"${this.player.getSchema().filterSlider.max}\"\n            value=${this.player.get('filterSlider')}\n            @input=${e => this.updateFilterSlider(e.target.value)}\n          ></sc-slider>\n          <p>Filter</p>\n        </div>\n      </div>\n    `;\n  }\n}\n\n// register the component into the custom elements registry\ncustomElements.define('sw-player', SwPlayer);\n"],"mappings":"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"}
