{"version":3,"names":["Client","launcher","pluginPlatformInit","html","createLayout","Engine","config","window","SOUNDWORKS_CONFIG","audioContext","AudioContext","main","$container","client","pluginManager","register","initScreensContainer","start","player","stateManager","create","id","$layout","destination","channelCount","resume","merger","createChannelMerger","chArray","forEach","i","engine","env","connect","onUpdate","requestUpdate","render","addComponent","execute","numClients","parseInt","URLSearchParams","location","search","get"],"sources":["../../../src/clients/web-player/index.js"],"sourcesContent":["import '@soundworks/helpers/polyfills.js';\nimport { Client } from '@soundworks/core/client.js';\nimport launcher from '@soundworks/helpers/launcher.js';\nimport pluginPlatformInit from '@soundworks/plugin-platform-init/client.js';\n\nimport { html } from 'lit';\n\nimport createLayout from './layout.js';\n\nimport '@ircam/sc-components/sc-slider.js';\nimport '@ircam/sc-components/sc-number.js';\nimport '@ircam/sc-components/sc-toggle.js';\nimport '@ircam/sc-components/sc-select.js';\n\nimport '../components/sw-player.js';\n\nimport Engine from '../components/engine.js';\n\n// - General documentation: https://soundworks.dev/\n// - API documentation:     https://soundworks.dev/api\n// - Issue Tracker:         https://github.com/collective-soundworks/soundworks/issues\n// - Wizard & Tools:        `npx soundworks`\n\n/**\n * Grab the configuration object written by the server in the `index.html`\n */\nconst config = window.SOUNDWORKS_CONFIG;\n\nconst audioContext = new AudioContext();\n\n/**\n * If multiple clients are emulated you might to want to share some resources\n */\n// const audioContext = new AudioContext();\n\nasync function main($container) {\n  /**\n   * Create the soundworks client\n   */\n  const client = new Client(config);\n  client.pluginManager.register('platform-init', pluginPlatformInit, { audioContext });\n\n  /**\n   * Register some soundworks plugins, you will need to install the plugins\n   * before hand (run `npx soundworks` for help)\n   */\n  // client.pluginManager.register('my-plugin', plugin);\n\n  /**\n   * Register the soundworks client into the launcher\n   *\n   * The launcher will do a bunch of stuff for you:\n   * - Display default initialization screens. If you want to change the provided\n   * initialization screens, you can import all the helpers directly in your\n   * application by doing `npx soundworks --eject-helpers`. You can also\n   * customise some global syles variables (background-color, text color etc.)\n   * in `src/clients/components/css/app.scss`.\n   * You can also change the default language of the intialization screen by\n   * setting, the `launcher.language` property, e.g.:\n   * `launcher.language = 'fr'`\n   * - By default the launcher automatically reloads the client when the socket\n   * closes or when the page is hidden. Such behavior can be quite important in\n   * performance situation where you don't want some phone getting stuck making\n   * noise without having any way left to stop it... Also be aware that a page\n   * in a background tab will have all its timers (setTimeout, etc.) put in very\n   * low priority, messing any scheduled events.\n   */\n  launcher.register(client, { initScreensContainer: $container });\n\n  /**\n   * Launch application\n   */\n\n  await client.start();\n\n  const player = await client.stateManager.create('player', {\n    id: client.id,\n  });\n\n  // The `$layout` is provided as a convenience and is not required by soundworks,\n  // its full source code is located in the `./views/layout.js` file, so feel free\n  // to edit it to match your needs or even to delete it.\n  const $layout = createLayout(client, $container);\n\n  audioContext.destination.channelCount = 16;\n  await audioContext.resume();\n\n  const merger = audioContext.createChannelMerger(16); // 8 in, 1 out\n\n  const chArray = [0, 1, 2, 3, 6, 7, 9, 10];\n\n  chArray.forEach((i) => {\n    const engine = new Engine(audioContext, player);\n    engine.env.connect(merger, 0, i);\n    player.onUpdate(() => {\n      $layout.requestUpdate();\n      engine.render();\n    })\n  });\n\n  merger.connect(audioContext.destination);\n\n  $layout.addComponent(html`<sw-player .player=${player}></sc-player>`);\n\n}\n\n// The launcher enables instanciation of multiple clients in the same page to\n// facilitate development and testing.\n// e.g. `http://127.0.0.1:8000?emulate=10` to run 10 clients side-by-side\nlauncher.execute(main, {\n  numClients: parseInt(new URLSearchParams(window.location.search).get('emulate')) || 1,\n});\n"],"mappings":"AAAA,OAAO,kCAAkC;AACzC,SAASA,MAAM,QAAQ,4BAA4B;AACnD,OAAOC,QAAQ,MAAM,iCAAiC;AACtD,OAAOC,kBAAkB,MAAM,4CAA4C;AAE3E,SAASC,IAAI,QAAQ,KAAK;AAE1B,OAAOC,YAAY,MAAM,aAAa;AAEtC,OAAO,mCAAmC;AAC1C,OAAO,mCAAmC;AAC1C,OAAO,mCAAmC;AAC1C,OAAO,mCAAmC;AAE1C,OAAO,4BAA4B;AAEnC,OAAOC,MAAM,MAAM,yBAAyB;;AAE5C;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAMC,MAAM,GAAGC,MAAM,CAACC,iBAAiB;AAEvC,MAAMC,YAAY,GAAG,IAAIC,YAAY,CAAC,CAAC;;AAEvC;AACA;AACA;AACA;;AAEA,eAAeC,IAAIA,CAACC,UAAU,EAAE;EAC9B;AACF;AACA;EACE,MAAMC,MAAM,GAAG,IAAIb,MAAM,CAACM,MAAM,CAAC;EACjCO,MAAM,CAACC,aAAa,CAACC,QAAQ,CAAC,eAAe,EAAEb,kBAAkB,EAAE;IAAEO;EAAa,CAAC,CAAC;;EAEpF;AACF;AACA;AACA;EACE;;EAEA;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACER,QAAQ,CAACc,QAAQ,CAACF,MAAM,EAAE;IAAEG,oBAAoB,EAAEJ;EAAW,CAAC,CAAC;;EAE/D;AACF;AACA;;EAEE,MAAMC,MAAM,CAACI,KAAK,CAAC,CAAC;EAEpB,MAAMC,MAAM,GAAG,MAAML,MAAM,CAACM,YAAY,CAACC,MAAM,CAAC,QAAQ,EAAE;IACxDC,EAAE,EAAER,MAAM,CAACQ;EACb,CAAC,CAAC;;EAEF;EACA;EACA;EACA,MAAMC,OAAO,GAAGlB,YAAY,CAACS,MAAM,EAAED,UAAU,CAAC;EAEhDH,YAAY,CAACc,WAAW,CAACC,YAAY,GAAG,EAAE;EAC1C,MAAMf,YAAY,CAACgB,MAAM,CAAC,CAAC;EAE3B,MAAMC,MAAM,GAAGjB,YAAY,CAACkB,mBAAmB,CAAC,EAAE,CAAC,CAAC,CAAC;;EAErD,MAAMC,OAAO,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC;EAEzCA,OAAO,CAACC,OAAO,CAAEC,CAAC,IAAK;IACrB,MAAMC,MAAM,GAAG,IAAI1B,MAAM,CAACI,YAAY,EAAES,MAAM,CAAC;IAC/Ca,MAAM,CAACC,GAAG,CAACC,OAAO,CAACP,MAAM,EAAE,CAAC,EAAEI,CAAC,CAAC;IAChCZ,MAAM,CAACgB,QAAQ,CAAC,MAAM;MACpBZ,OAAO,CAACa,aAAa,CAAC,CAAC;MACvBJ,MAAM,CAACK,MAAM,CAAC,CAAC;IACjB,CAAC,CAAC;EACJ,CAAC,CAAC;EAEFV,MAAM,CAACO,OAAO,CAACxB,YAAY,CAACc,WAAW,CAAC;EAExCD,OAAO,CAACe,YAAY,CAAClC,IAAK,sBAAqBe,MAAO,eAAc,CAAC;AAEvE;;AAEA;AACA;AACA;AACAjB,QAAQ,CAACqC,OAAO,CAAC3B,IAAI,EAAE;EACrB4B,UAAU,EAAEC,QAAQ,CAAC,IAAIC,eAAe,CAAClC,MAAM,CAACmC,QAAQ,CAACC,MAAM,CAAC,CAACC,GAAG,CAAC,SAAS,CAAC,CAAC,IAAI;AACtF,CAAC,CAAC"}
