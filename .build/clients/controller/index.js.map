{"version":3,"names":["Client","launcher","createLayout","html","nothing","keyed","config","window","SOUNDWORKS_CONFIG","main","$container","client","register","initScreensContainer","reloadOnVisibilityChange","start","$layout","players","stateManager","getCollection","remoteControlledPlayer","addComponent","render","map","player","get","e","requestUpdate","onAttach","onDetach","execute","numClients","parseInt","URLSearchParams","location","search","width"],"sources":["../../../src/clients/controller/index.js"],"sourcesContent":["import '@soundworks/helpers/polyfills.js';\nimport { Client } from '@soundworks/core/client.js';\nimport launcher from '@soundworks/helpers/launcher.js';\n\nimport createLayout from './layout.js';\n\n\nimport { html, nothing } from 'lit';\nimport { keyed } from 'lit/directives/keyed.js';\nimport '@ircam/simple-components/sc-button.js';\nimport '../components/sw-player.js';\n\n// import { html } from 'lit';\n\n// - General documentation: https://soundworks.dev/\n// - API documentation:     https://soundworks.dev/api\n// - Issue Tracker:         https://github.com/collective-soundworks/soundworks/issues\n// - Wizard & Tools:        `npx soundworks`\n\nconst config = window.SOUNDWORKS_CONFIG;\n\nasync function main($container) {\n  const client = new Client(config);\n\n  launcher.register(client, {\n    initScreensContainer: $container,\n    reloadOnVisibilityChange: false,\n  });\n\n  await client.start();\n\n  const $layout = createLayout(client, $container);\n\n  // const globals = await client.stateManager.attach('globals');\n  const players = await client.stateManager.getCollection('player');\n\n  // placeholder of the remote controlled player state instance\n  let remoteControlledPlayer = null;\n  // collection\n  $layout.addComponent({\n    render: () => {\n      return html`\n        <h2>Connected players</h2>\n        ${players.map(player => {\n          return html`\n            <sc-button\n              value=${player.get('id')}\n              @input=${e => {\n                remoteControlledPlayer = player;\n                $layout.requestUpdate();\n              }}\n            ></sc-button>\n          `;\n        })}\n        <h2>Remote controlled player</h2>\n        ${remoteControlledPlayer !== null\n          ? keyed(\n              remoteControlledPlayer.get('id'),\n              html`<sw-player .player=${remoteControlledPlayer}></sw-player>`\n            )\n          : nothing\n        }\n      `;\n    }\n  });\n\n  // if a player connects or disconnect, we want to update the view accordingly\n  players.onAttach(() => $layout.requestUpdate());\n  players.onDetach(player => {\n    // if the player is deleted, we reset the view\n    if (player === remoteControlledPlayer) {\n      remoteControlledPlayer = null;\n    }\n    $layout.requestUpdate();\n  });\n\n  // ...\n  // $layout.addComponent(html`<h1>ok</h1>`);\n\n  // setTimeout(() => {\n  //   console.log($layout.querySelector('h1'));\n  // }, 100);\n}\n\nlauncher.execute(main, {\n  numClients: parseInt(new URLSearchParams(window.location.search).get('emulate')) || 1,\n  width: '50%',\n});\n"],"mappings":"AAAA,OAAO,kCAAkC;AACzC,SAASA,MAAM,QAAQ,4BAA4B;AACnD,OAAOC,QAAQ,MAAM,iCAAiC;AAEtD,OAAOC,YAAY,MAAM,aAAa;AAGtC,SAASC,IAAI,EAAEC,OAAO,QAAQ,KAAK;AACnC,SAASC,KAAK,QAAQ,yBAAyB;AAC/C,OAAO,uCAAuC;AAC9C,OAAO,4BAA4B;;AAEnC;;AAEA;AACA;AACA;AACA;;AAEA,MAAMC,MAAM,GAAGC,MAAM,CAACC,iBAAiB;AAEvC,eAAeC,IAAIA,CAACC,UAAU,EAAE;EAC9B,MAAMC,MAAM,GAAG,IAAIX,MAAM,CAACM,MAAM,CAAC;EAEjCL,QAAQ,CAACW,QAAQ,CAACD,MAAM,EAAE;IACxBE,oBAAoB,EAAEH,UAAU;IAChCI,wBAAwB,EAAE;EAC5B,CAAC,CAAC;EAEF,MAAMH,MAAM,CAACI,KAAK,CAAC,CAAC;EAEpB,MAAMC,OAAO,GAAGd,YAAY,CAACS,MAAM,EAAED,UAAU,CAAC;;EAEhD;EACA,MAAMO,OAAO,GAAG,MAAMN,MAAM,CAACO,YAAY,CAACC,aAAa,CAAC,QAAQ,CAAC;;EAEjE;EACA,IAAIC,sBAAsB,GAAG,IAAI;EACjC;EACAJ,OAAO,CAACK,YAAY,CAAC;IACnBC,MAAM,EAAEA,CAAA,KAAM;MACZ,OAAOnB,IAAK;AAClB;AACA,UAAUc,OAAO,CAACM,GAAG,CAACC,MAAM,IAAI;QACtB,OAAOrB,IAAK;AACtB;AACA,sBAAsBqB,MAAM,CAACC,GAAG,CAAC,IAAI,CAAE;AACvC,uBAAuBC,CAAC,IAAI;UACZN,sBAAsB,GAAGI,MAAM;UAC/BR,OAAO,CAACW,aAAa,CAAC,CAAC;QACzB,CAAE;AAChB;AACA,WAAW;MACH,CAAC,CAAE;AACX;AACA,UAAUP,sBAAsB,KAAK,IAAI,GAC7Bf,KAAK,CACHe,sBAAsB,CAACK,GAAG,CAAC,IAAI,CAAC,EAChCtB,IAAK,sBAAqBiB,sBAAuB,eACnD,CAAC,GACDhB,OACH;AACT,OAAO;IACH;EACF,CAAC,CAAC;;EAEF;EACAa,OAAO,CAACW,QAAQ,CAAC,MAAMZ,OAAO,CAACW,aAAa,CAAC,CAAC,CAAC;EAC/CV,OAAO,CAACY,QAAQ,CAACL,MAAM,IAAI;IACzB;IACA,IAAIA,MAAM,KAAKJ,sBAAsB,EAAE;MACrCA,sBAAsB,GAAG,IAAI;IAC/B;IACAJ,OAAO,CAACW,aAAa,CAAC,CAAC;EACzB,CAAC,CAAC;;EAEF;EACA;;EAEA;EACA;EACA;AACF;;AAEA1B,QAAQ,CAAC6B,OAAO,CAACrB,IAAI,EAAE;EACrBsB,UAAU,EAAEC,QAAQ,CAAC,IAAIC,eAAe,CAAC1B,MAAM,CAAC2B,QAAQ,CAACC,MAAM,CAAC,CAACV,GAAG,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC;EACrFW,KAAK,EAAE;AACT,CAAC,CAAC"}
